<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Cartel % A6</title>
<style>
  @page { size: A4; margin: 0; }

  /* Fuentes (inyectadas por backend si usás base64) */
  @font-face{ font-family:'Miso'; src:url('data:font/ttf;base64,{{MISO_LIGHT_BASE64}}') format('truetype'); font-weight:300; font-style:normal; }
  @font-face{ font-family:'Miso'; src:url('data:font/ttf;base64,{{MISO_REGULAR_BASE64}}') format('truetype'); font-weight:400; font-style:normal; }
  @font-face{ font-family:'Miso'; src:url('data:font/ttf;base64,{{MISO_BOLD_BASE64}}')    format('truetype'); font-weight:700; font-style:normal; }

  :root{
    --ancho-contenido: 95mm;

    /* columnas y alineaciones */
    --col-left: 32mm;                 /* columna del precio tachado */
    --right-inset: 2mm;               /* mete botón/código desde la derecha */
    --shift-x: 0mm;                   /* centro total del bloque (0 = no se corre) */

    /* ESPACIOS CLAVE */
    --aire-centro: 6mm;               /* aire igual arriba/abajo del precio final */
    --subir-inferior: 2mm;            /* cuánto sube el bloque inferior */

    /* tamaños */
    --final-entero: 34px;  --final-dec: 16px;
    --orig-entero:  26px;  --orig-dec:  16px;

    /* código de barras */
    --barcode-width: 26mm; --barcode-height: 15mm;

    /* microalineación $ y C/U */
    --shift-simbolos-final: .30em;
    --shift-simbolos-orig:  .36em;

    /* parámetros del tachado */
    --fix-tachado: 3mm;     /* empuje del bloque tachado hacia adentro (SIN recortes) */
    --tach-l: 8%;           /* largo del tachado dentro de los dígitos (menor = más corto) */

    /* === NUEVO: centrado robusto del número de descuento === */
    --ajuste-desc: -1.2mm;  /* subir = valor más negativo; bajar = menos negativo */
    --colchon-negro: 1.6mm; /* “acolchado” superior/inferior dentro del rectángulo negro */
  }

  body{ margin:0; padding:0; width:210mm; height:297mm; font-family:'Miso',sans-serif; }

  /* A6 posicionado por el backend (top/left) */
  .contenedor-a6{
    position:absolute; top:{{top}}mm; left:{{left}}mm;
    width:105mm; height:148.5mm; box-sizing:border-box; transform-origin:top left;
    display:flex; flex-direction:column; align-items:center; padding-top:21mm; overflow:hidden;
  }

  /* Título y franja % */
  .titulo{ font-size:32pt; font-weight:700; text-align:center; margin:10mm 0 5mm 0; }
  .descuento{ width:var(--ancho-contenido); height:30mm; display:flex; margin:0; }
  .lado-blanco{
    width:37%; background:#fff; display:flex; align-items:center; justify-content:center;
    border:2px solid #000; border-right:none; position:relative;
  }
  .lado-blanco::before{
    content:''; position:absolute; right:-29px; top:50%; transform:translateY(-50%);
    width:0; height:0; border-top:50px solid transparent; border-bottom:60px solid transparent; border-left:30px solid #fff;
  }
  .lado-negro{
    width:75%; background:#000; color:#fff; display:flex; align-items:center; justify-content:center;
    border:2px solid #000; border-left:none;
    /* acolchado interno para evitar recortes en distintos renderers */
    padding-block: var(--colchon-negro);
  }
  .texto-lleva{ font-size:30px; font-weight:700; line-height:1.2; text-align:center; }

  /* CENTRADO del número en todos los motores (quita translateY) */
  .valor-descuento{
    font-size:100px;
    letter-spacing:-8px;
    color:#fff;
    font-weight:400;
    line-height:1;                /* altura igual al texto → centra bien */
    transform:none !important;    /* evita variaciones entre motores PDF */
    position:relative;
    top: var(--ajuste-desc);      /* <- mover acá si hace falta afinar */
    display:inline-block;
    margin:0; padding:0; white-space:nowrap;
  }

  /* —— Layout vertical con centro elástico —— */
  .layout{
    width:var(--ancho-contenido);
    flex:1 1 auto;
    display:grid;
    grid-template-rows: min-content 1fr min-content; /* [franja][centro elástico][bloque inferior] */
    row-gap: 0;
    align-self:center;
    transform: translateX(var(--shift-x));
  }
  .centro{
    display:grid; place-items:center;
    padding-block: var(--aire-centro);  /* aire SIMÉTRICO arriba/abajo del precio final */
  }

  /* Grilla de 3 columnas (arriba y abajo) */
  .grupo-final,
  .grupo-orig{
    width:var(--ancho-contenido); box-sizing:border-box;
    display:grid; grid-template-columns: var(--col-left) minmax(34mm,1fr) var(--barcode-width);
    align-items:center;
    padding-right: var(--right-inset);
    margin:0;
  }

  /* Fila ARRIBA: precio final centrado + botón alineado a la derecha (como el código) */
  .precio-final-grande{ grid-column:2; justify-self:center; }
  .sello-html-ajustado{
    grid-column:3; justify-self:end; width:18mm; height:18mm;
    background:#000; border-radius:50%; color:#fff;
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    text-align:center; letter-spacing:-0.2px; line-height:1.05;
  }
  .sello-html-ajustado .linea1{ font-size:11px; }
  .sello-html-ajustado .linea2{ font-size:12px; font-weight:700; }
  .sello-html-ajustado .linea3{ font-size:13px; font-weight:700; }

  /* Fila ABAJO: acercamos un poco hacia el centro */
  .grupo-orig{ transform: translateY(calc(-1 * var(--subir-inferior))); }

  /* === BLOQUE TACHADO (fix de recortes) === */
  .precio-original-cruz{
    grid-column:1;
    position:relative; display:inline-block; margin:0;
    margin-left: var(--fix-tachado);   /* desplazo sin recortar */
  }
  .precio-original-cruz::before,
  .precio-original-cruz::after{ content:none; } /* no tachar el contenedor */
  /* …tachamos SOLO los dígitos para no tapar $ / C/U */
  .precio-original-cruz .precio-numeros{ position:relative; }
  .precio-original-cruz .precio-numeros::before,
  .precio-original-cruz .precio-numeros::after{
    content:''; position:absolute; top:50%;
    left:var(--tach-l); right:var(--tach-l);
    border-top:1px solid #000; transform-origin:center;
  }
  .precio-original-cruz .precio-numeros::before{ transform:rotate(15deg); }
  .precio-original-cruz .precio-numeros::after{  transform:rotate(-15deg); }

  /* INFO */
  .info{
    grid-column:2; justify-self:center;
    display:block; text-align:center; margin:0;
    font-size:9.5pt; line-height:1.15;
  }

  /* Código de barras alineado con el botón */
  .codigo-barras-posicionado{
    grid-column:3; justify-self:end;
    width:var(--barcode-width); height:var(--barcode-height);
    object-fit:contain; max-width:100%;
  }

  /* Tipografías de precios y símbolos */
  .precio-contenedor{ display:flex; align-items:flex-start; gap:1.5mm; }
  .precio-numeros{ display:flex; align-items:baseline; }
  .grupo-final .simbolos{ display:flex; flex-direction:column; align-items:flex-end; line-height:1; transform:translateY(var(--shift-simbolos-final)); font-size:15px; }
  .grupo-orig  .simbolos{ display:flex; flex-direction:column; align-items:flex-end; line-height:1; transform:translateY(var(--shift-simbolos-orig));  font-size:15px; }
  .grupo-final .precio-numeros .entero{ font-size:var(--final-entero); line-height:.95; }
  .grupo-final .precio-numeros .decimales{ font-size:var(--final-dec); position:relative; top:-2px; margin-left:2px; }
  .grupo-orig  .precio-numeros .entero{  font-size:var(--orig-entero);  line-height:.95; }
  .grupo-orig  .precio-numeros .decimales{font-size:var(--orig-dec);   position:relative; top:-2px; margin-left:2px; }
</style>
</head>
<body>

  <div class="contenedor-a6">
    <div class="titulo">{{descripcion}}</div>

    <!-- Layout vertical estable -->
    <div class="layout">
      <!-- Franja de descuento (arriba) -->
      <div class="descuento">
        <div class="lado-blanco"><span class="texto-lleva">LLEVÁS<br>1X</span></div>
        <div class="lado-negro"><span class="valor-descuento">-{{descuento}}%</span></div>
      </div>

      <!-- Centro: precio final + botón con aire simétrico -->
      <div class="centro">
        <div class="grupo-final">
          <div></div>
          <div class="precio-final-grande">
            <div class="precio-contenedor">
              <div class="simbolos"><div class="peso">$</div><div class="cu">C/U</div></div>
              <div class="precio-numeros">
                <span class="entero">{{precioFinalEntero}}</span><span class="decimales">{{precioFinalDecimales}}</span>
              </div>
            </div>
          </div>
          <div class="sello-html-ajustado">
            <div class="linea1">PRECIO CON</div>
            <div class="linea2">DESCUENTO</div>
            <div class="linea3">INCLUIDO</div>
          </div>
        </div>
      </div>

      <!-- Abajo: tachado + info + código -->
      <div class="grupo-orig">
        <div class="precio-original-cruz">
          <div class="precio-contenedor">
            <div class="simbolos"><div class="peso">$</div><div class="cu">C/U</div></div>
            <div class="precio-numeros">
              <span class="entero">{{precioOriginalEntero}}</span><span class="decimales">{{precioOriginalDecimales}}</span>
            </div>
          </div>
        </div>

        <div class="info">
          Origen: Argentina<br>
          VIGENCIA<br>
          del {{desde}} al {{hasta}}<br>
          dept: {{departamento}} - item: {{item}}
        </div>

        <img class="codigo-barras-posicionado" src="{{barcode}}" alt="Código de barras" />
      </div>
    </div>
  </div>

</body>
</html>
